{
  "openapi": "3.0.0",
  "info": {
    "title": "CoDoc 协作文档 API",
    "version": "1.0.0",
    "description": "分布式实时协作文档系统 API 文档"
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "本地开发服务器"
    }
  ],
  "tags": [
    { "name": "认证", "description": "用户认证相关接口 [已完成]" },
    { "name": "用户", "description": "用户信息管理 [待开发]" },
    { "name": "文档", "description": "文档 CRUD 操作 [待开发]" },
    { "name": "协作", "description": "文档协作者管理 [待开发]" }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "Result": {
        "type": "object",
        "properties": {
          "code": { "type": "integer", "example": 200 },
          "message": { "type": "string", "example": "success" },
          "data": { "type": "object" }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "id": { "type": "integer", "example": 1 },
          "username": { "type": "string", "example": "zhangsan" },
          "nickname": { "type": "string", "example": "张三" },
          "email": { "type": "string", "example": "zhangsan@example.com" },
          "avatar": { "type": "string", "example": "https://example.com/avatar.png" },
          "createdAt": { "type": "string", "example": "2025-12-06 10:00:00" }
        }
      },
      "Document": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "example": "doc-001" },
          "title": { "type": "string", "example": "项目需求文档" },
          "content": { "type": "string", "example": "文档内容..." },
          "ownerId": { "type": "integer", "example": 1 },
          "ownerName": { "type": "string", "example": "张三" },
          "createdAt": { "type": "string", "example": "2025-12-06 10:00:00" },
          "updatedAt": { "type": "string", "example": "2025-12-06 15:30:00" }
        }
      },
      "DocumentListItem": {
        "type": "object",
        "properties": {
          "id": { "type": "string", "example": "doc-001" },
          "title": { "type": "string", "example": "项目需求文档" },
          "ownerName": { "type": "string", "example": "张三" },
          "updatedAt": { "type": "string", "example": "2025-12-06 15:30:00" },
          "permission": { "type": "string", "enum": ["owner", "edit", "view"], "example": "owner" }
        }
      },
      "Collaborator": {
        "type": "object",
        "properties": {
          "userId": { "type": "integer", "example": 2 },
          "username": { "type": "string", "example": "lisi" },
          "nickname": { "type": "string", "example": "李四" },
          "avatar": { "type": "string", "example": "https://example.com/avatar2.png" },
          "permission": { "type": "string", "enum": ["edit", "view"], "example": "edit" }
        }
      }
    }
  },
  "paths": {
    "/api/auth/register": {
      "post": {
        "tags": ["认证"],
        "summary": "用户注册",
        "description": "[已完成] 注册新用户账号",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["username", "password"],
                "properties": {
                  "username": { "type": "string", "minLength": 3, "maxLength": 20, "example": "zhangsan" },
                  "password": { "type": "string", "minLength": 6, "example": "123456" },
                  "nickname": { "type": "string", "example": "张三" },
                  "email": { "type": "string", "format": "email", "example": "zhangsan@example.com" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "注册成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "type": "null" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/login": {
      "post": {
        "tags": ["认证"],
        "summary": "用户登录",
        "description": "[已完成] 用户登录获取 JWT Token",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["username", "password"],
                "properties": {
                  "username": { "type": "string", "example": "zhangsan" },
                  "password": { "type": "string", "example": "123456" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "登录成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "token": { "type": "string", "example": "eyJhbGciOiJIUzI1NiJ9..." },
                        "userId": { "type": "integer", "example": 1 },
                        "username": { "type": "string", "example": "zhangsan" },
                        "nickname": { "type": "string", "example": "张三" },
                        "avatar": { "type": "string", "example": null }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/user/info": {
      "get": {
        "tags": ["用户"],
        "summary": "获取当前用户信息",
        "description": "[待开发] 获取当前登录用户的详细信息",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "$ref": "#/components/schemas/User" }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["用户"],
        "summary": "更新用户信息",
        "description": "[待开发] 更新当前用户的昵称、头像等信息",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "nickname": { "type": "string", "example": "新昵称" },
                  "avatar": { "type": "string", "example": "https://example.com/new-avatar.png" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Result" }
              }
            }
          }
        }
      }
    },
    "/api/documents": {
      "get": {
        "tags": ["文档"],
        "summary": "获取文档列表",
        "description": "[待开发] 获取当前用户有权限访问的所有文档",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": { "type": "integer", "default": 1 },
            "description": "页码"
          },
          {
            "name": "size",
            "in": "query",
            "schema": { "type": "integer", "default": 20 },
            "description": "每页数量"
          },
          {
            "name": "keyword",
            "in": "query",
            "schema": { "type": "string" },
            "description": "搜索关键词"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "total": { "type": "integer", "example": 100 },
                        "list": {
                          "type": "array",
                          "items": { "$ref": "#/components/schemas/DocumentListItem" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["文档"],
        "summary": "创建文档",
        "description": "[待开发] 创建一个新文档",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string", "example": "新建文档" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": { "type": "string", "example": "doc-abc123" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/documents/{id}": {
      "get": {
        "tags": ["文档"],
        "summary": "获取文档详情",
        "description": "[待开发] 获取指定文档的详细信息和内容",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "文档ID"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": { "$ref": "#/components/schemas/Document" }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["文档"],
        "summary": "更新文档",
        "description": "[待开发] 更新文档标题（内容通过 WebSocket 实时同步）",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "文档ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string", "example": "修改后的标题" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Result" }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["文档"],
        "summary": "删除文档",
        "description": "[待开发] 删除指定文档（仅文档所有者可操作）",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "文档ID"
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Result" }
              }
            }
          }
        }
      }
    },
    "/api/documents/{id}/collaborators": {
      "get": {
        "tags": ["协作"],
        "summary": "获取协作者列表",
        "description": "[待开发] 获取文档的所有协作者",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "文档ID"
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": { "type": "integer", "example": 200 },
                    "message": { "type": "string", "example": "success" },
                    "data": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/Collaborator" }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["协作"],
        "summary": "添加协作者",
        "description": "[待开发] 邀请用户协作编辑文档",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "文档ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["username", "permission"],
                "properties": {
                  "username": { "type": "string", "example": "lisi", "description": "要邀请的用户名" },
                  "permission": { "type": "string", "enum": ["edit", "view"], "example": "edit", "description": "权限类型" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Result" }
              }
            }
          }
        }
      }
    },
    "/api/documents/{id}/collaborators/{userId}": {
      "delete": {
        "tags": ["协作"],
        "summary": "移除协作者",
        "description": "[待开发] 从文档中移除协作者",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "string" },
            "description": "文档ID"
          },
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "schema": { "type": "integer" },
            "description": "要移除的用户ID"
          }
        ],
        "responses": {
          "200": {
            "description": "移除成功",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Result" }
              }
            }
          }
        }
      }
    }
  }
}

